<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run SQuID without graphical user interface — squidR • squid</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run SQuID without graphical user interface — squidR" />
<meta property="og:description" content="The function simulates a world inhabited by individuals whose phenotypes are generated by a user-defined phenotypic equation and then samples from this world according to a user-defined sampling design. If this is your first experience with SQuID, we highly recommend to start with the interactive SQuID application with graphical interface in order to learn and get more familiarized with the SQuID model and its sampling design (use the function squidApp)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">squid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/squid-group/squid/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run SQuID without graphical user interface</h1>
    
    <div class="hidden name"><code>squidR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function simulates a world inhabited by individuals whose phenotypes are generated by a user-defined phenotypic equation and then samples from this world according to a user-defined sampling design. If this is your first experience with SQuID, we highly recommend to start with the interactive SQuID application with graphical interface in order to learn and get more familiarized with the SQuID model and its sampling design (use the function <code><a href='squidApp.html'>squidApp</a></code>).</p>
    </div>

    <pre class="usage"><span class='fu'>squidR</span><span class='op'>(</span>input<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, plot<span class='op'>=</span><span class='cn'>FALSE</span>, data<span class='op'>=</span><span class='cn'>NULL</span>, module<span class='op'>=</span><span class='cn'>NULL</span>, 
       X_previsualization<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>input</th>
      <td><p>A <code>list</code> of the model input parameters (see Details).</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p><code>logical</code>; If <code>FALSE</code> (default), <code>squidR</code> does not include the simulation plots into the output list (see Value).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A <code>data.frame</code> of the full data (the "world") returned by <code>squidR</code> (<code>output$full_data</code>).</p></td>
    </tr>
    <tr>
      <th>module</th>
      <td><p>A <code>character string</code> of the module name. This argument is only used by SQuID app.</p></td>
    </tr>
    <tr>
      <th>X_previsualization</th>
      <td><p>A <code>character string</code> of the environment name. This argument is only used by SQuID app.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>squidR</code> returns a <code>list</code> that includes a <code>data.frame</code> of the full data generated (the "world"), a <code>data.frame</code> of the sampled data and six <a href='https://cran.r-project.org/package=ggplot2'>ggplot2</a> plots of the results (only if <code>plot</code> is set to <code>TRUE</code>).</p>
<p>The full and the sampled data could be accessed respectively by <code>output$full_data</code> and <code>output$sampled_data</code>.
A description of the columns of the full and the sampled <code>data.frame</code> is provided below:</p>
<p></p><ul>
<li><p><code>Replicate</code>: (factor) the replicated population identifier.</p></li>
<li><p><code>Individual</code>: (factor) the individual identifier.</p></li>
<li><p><code>Group</code>: (factor) the high-level grouping identifier.</p></li>
<li><p><code>Individual_Trait</code>: (factor) the identifier of each individual/trait combination.</p></li>
<li><p><code>Trait</code>: (factor) the trait identifier.</p></li>
<li><p><code>Time</code>: (integer) the time step value.</p></li>
<li><p><code>Phenotype</code>: (numeric) the individual phenotype.</p></li>
<li><p><code>Beta0</code>: (numeric) the population phenotypic mean.</p></li>
<li><p><code>Beta1</code>: (numeric) the population mean response to environmental influences x1.</p></li>
<li><p><code>Beta2</code>: (numeric) the population mean response to environmental influences x2.</p></li>
<li><p><code>Beta12</code>: (numeric) the population mean response to environmental influences x1x2 (the interaction between the environmental effect x1 and the environmental effect x2).</p></li>
<li><p><code>I</code>: (numeric) the individual-specific deviations (random-intercepts) from the population phenotypic mean <code>Beta0</code>.</p></li>
<li><p><code>S1</code>: (numeric) the individual-specific response to the environmental influence x1 (random-slope).</p></li>
<li><p><code>S2</code>: (numeric) the individual-specific response to the environmental influence x2 (random-slope).</p></li>
<li><p><code>S12</code>: (numeric) the individual-specific response to the environmental influence x1x2 (the interaction between the environmental effect x1 and the environmental effect x2; random-slope).</p></li>
<li><p><code>X1</code>: (numeric) the environmental gradient x1.</p></li>
<li><p><code>X2</code>: (numeric) the environmental gradient x2.</p></li>
<li><p><code>X1X2</code>: (numeric) the environmental gradient x1x2 (the interaction between the environmental effect x1 and the environmental effect x2).</p></li>
<li><p><code>G</code>: (numeric) the higher-level grouping value.</p></li>
<li><p><code>e</code>: (numeric) the measurement error.</p></li>
</ul>
  
<p><code>squidR</code> returns a list that also includes a list (<code>plots</code>) of six <a href='https://cran.r-project.org/package=ggplot2'>ggplot2</a> plots of the results. Note that the plots display only the data of the first trait, the first replicate and the first 20 individuals of the simulation.</p>
<ul>
<li><p><code>$plots$X1</code>: a plot of the environmental gradient x1.</p></li>
<li><p><code>$plots$X2</code>: a plot of the environmental gradient x2.</p></li>
<li><p><code>$plots$X1X2</code>: a plot of the environmental gradient x1x2 (the interaction between the environmental effect x1 and the environmental effect x2).</p></li>
<li><p><code>$plots$totPhen</code>: a plot of the raw individual phenotype over time.</p></li>
<li><p><code>$plots$sampPhen</code>: a plot of the sampled individual phenotype over time.</p></li>
<li><p><code>$plots$sampTime</code>: a plot of the sampling time of each individual.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A detailed description of the SQuID model and its sampling design is provided on the SQuID app (run SQuID app with <code><a href='squidApp.html'>squidApp</a></code>). Reading the SQuID documentation on the SQuID app is prerequisite to use properly the SQuID R function.</p>
<p>The argument <code>input</code> is a list that contains the different input parameters to the SQuID model. All the parameters are listed below including their default value and a short description. If a parameter is not declared within the <code>input</code> list, the default value will be used.</p> 
<ul>
<li><p><code>Tmax</code> (default 1): positive <code>integer</code>; the duration of the simulation (number of time steps).</p></li>
<li><p><code>NP</code> (default 1): positive <code>integer</code>; the number of replicated populations. The replicated populations are generated independently using the same simulation design that has been initially inputted by the user. Note that data from different populations will be saved in the same output file that you could later use to run statistical analyses.</p></li>
<li><p><code>NI</code> (default 1): positive <code>integer</code>; the number of individuals in each sampled population. <code>NI</code> must be divisible by the number of higher-level groups (<code>NG</code>).</p></li>
<li><p><code>NT</code> (default 1): positive <code>integer</code>; the number of traits for each individual. SQuID allows a maximum of 2 traits.</p></li>
<li><p><code>NG</code> (default 1): positive <code>integer</code>; the number of higher-level groups. <code>NG</code> must be lower than the number of individuals <code>NI</code>.</p></li>
<li><p><code>X1_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, an environmental effect x1 will be added to the model equation.</p></li>
<li><p><code>X1_sto_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, a stochastic environmental effect will be added to the environmental effect x1. The stochastic environmental effect values follow a normal distribution with a mean of 0 and a variance of <code>X1_sto_V</code>.</p></li>
<li><p><code>X1_sto_shared</code> (default <code>TRUE</code>): logical; if <code>TRUE</code>, the stochastic environmental effect included in the environmental effect x1 will be shared between individuals. If <code>FALSE</code>, each individual will experience a different stochastic environmental effect x1 (i.e. a new stochastic environmental effect is generated for each individual).</p></li>
<li><p><code>X1_sto_V</code> (default 1): <code>numeric</code>; the variance used to generate the normally distributed stochastic environmental effect x1.</p></li>
<li><p><code>X1_sto_autocor_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, an autocorrelation effect will be added to the stochastic environmental effect x1.</p></li>
<li><p><code>X1_sto_corr</code> (default 0): <code>numeric</code>; the correlation value ranging from 0 to 1 that characterizes the magnitude of the temporal autocorrelation between two consecutive time steps.</p></li>
<li><p><code>X1_lin_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, a linear trend will be added to the environmental effect x1.</p></li>
<li><p><code>X1_lin_shared</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, the linear trend included in the environmental effect x1 will be shared between individuals. If <code>FALSE</code>, each individual will experience a different linear trend within the environmental effect x1. A different linear trend is generated for each individual by varying the intercept and the slope of the linear equation. The variation in intercepts and slopes following a normal distribution with means <code>X1_lin_intercept</code>, <code>X1_lin_slope</code> and variance <code>X1_lin_V</code>.</p></li>
<li><p><code>X1_lin_intercept</code> (default 0): <code>numeric</code>; the intercept of the linear trend included into the environmental effect x1.</p></li>
<li><p><code>X1_lin_slope</code> (default 1): <code>numeric</code>; the slope of the linear trend included into the environmental effect x1.</p></li>
<li><p><code>X1_lin_V</code> (default 1): <code>numeric</code>; the variance used to generate different (unshared) linear trend effect for each individual within the environmental effect x1.</p></li>
<li><p><code>X1_cyc_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, a cyclic trend will be added the environmental effect x1.</p></li>
<li><p><code>X1_cyc_shared</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, the cyclic trend for environmental effect x1 will be shared between individuals. If <code>FALSE</code>, each individual will experience a different cyclic trend for environmental effect x1. A new cyclic trend is generated for each individual by varying the amplitude, the period, the horizontal shift and the vertical shift of the cyclic equation following a normal distribution where the mean is the parameter value itself and the variance is <code>X1_cyc_V</code>.</p></li>
<li><p><code>X1_cyc_amplitude</code> (default 10): positive <code>numeric</code>; the amplitude of the cyclic trend for environmental effect x1.</p></li>
<li><p><code>X1_cyc_period</code> (default 10): positive <code>numeric</code>; the period of the cyclic trend for the environmental effect x1.</p></li>
<li><p><code>X1_cyc_Hshift</code> (default 0): positive <code>numeric</code>; the horizontal shift of the cyclic trend for environmental effect x1.</p></li>
<li><p><code>X1_cyc_Vshift</code> (default 0): positive <code>numeric</code>; the vertical shift of the cyclic trend for environmental effect x1.</p></li>
<li><p><code>X1_cyc_V</code> (default 0): <code>numeric</code>; the variance used to generate different (unshared) cyclic trends for each individual in the environmental effect x1.</p></li>
<li><p><code>X2_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, an environmental effect x2 will be added to the model equation.</p></li>
<li><p><code>X2_sto_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, a stochastic environmental effect will be added to the environmental effect x2. The stochastic environmental effect values follow a normal distribution with mean of 0 and a variance of <code>X2_sto_V</code>.</p></li>
<li><p><code>X2_sto_shared</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, the stochastic environmental effect included in the environmental effect x2 will be shared between individuals. If <code>FALSE</code>, each individual will experience a different stochastic environmental effect  x2 (i.e. a new stochastic environmental effect is generated for each individual).</p></li>
<li><p><code>X2_sto_V</code> (default 1): <code>numeric</code>; the variance for the normally distributed stochastic environmental effect  x2.</p></li>
<li><p><code>X2_sto_autocor_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, an autocorrelation effect will be added to the stochastic environmental effect x2.</p></li>
<li><p><code>X2_sto_corr</code> (default 0): <code>numeric</code>; the correlation value ranging from 0 to 1 that characterizes the magnitude of the temporal autocorrelation between two consecutive time steps.</p></li>
<li><p><code>X2_lin_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, a linear trend will be added to the environmental effect x2.</p></li>
<li><p><code>X2_lin_shared</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, the linear trend included in the environmental effect x2 will be shared between individuals. If <code>FALSE</code>, each individual will experience a different linear trend within the environmental effect x2. A new linear trend is generated for each individual by varying the intercept and the slope of the linear equation. The variation in intercepts and slopes follow a normal distribution with means <code>X2_lin_intercept</code>, <code>X2_lin_slope</code> and variance <code>X2_lin_V</code>.</p></li>
<li><p><code>X2_lin_intercept</code> (default 0): <code>numeric</code>; the intercept of the linear trend for environmental effect x2.</p></li>
<li><p><code>X2_lin_slope</code> (default 1): <code>numeric</code>; the slope of the linear trend for environmental effect x2.</p></li>
<li><p><code>X2_lin_V</code> (default 1): <code>numeric</code>; the variance used to generate different (unshared) linear trend effect for each individual's environmental effect x2.</p></li>
<li><p><code>X2_cyc_state</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, a cyclic trend will be added the environmental effect x2.</p></li>
<li><p><code>X2_cyc_shared</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, the cyclic trend included in the environmental effect x2 will be shared between individuals. If <code>FALSE</code>, each individual will experience a different cyclic trend for the environmental effect x2. A new cyclic trend is generated for each individual by varying the amplitude, the period, the horizontal shift and the vertical shift of the cyclic equation following a normal distribution where the mean is the parameter value itself and the variance is <code>X2_cyc_V</code>.</p></li>
<li><p><code>X2_cyc_amplitude</code> (default 10): positive <code>numeric</code>; the amplitude of the cyclic trend included into the environmental effect x2.</p></li>
<li><p><code>X2_cyc_period</code> (default 10): positive <code>numeric</code>; the period of the cyclic trend for environmental effect x2.</p></li>
<li><p><code>X2_cyc_Hshift</code> (default 0): positive <code>numeric</code>; the horizontal shift of the cyclic trend for environmental effect x2.</p></li>
<li><p><code>X2_cyc_Vshift</code> (default 0): positive <code>numeric</code>; the vertical shift of the cyclic trend for environmental effect x2.</p></li>
<li><p><code>X2_cyc_V</code> (default 0): <code>numeric</code>; the variance used to generate different (unshared) cyclic trend effect for each individual within the environmental effect x2.</p></li>
<li><p><code>X_Interaction</code> (default <code>FALSE</code>): <code>logical</code>; if <code>TRUE</code>, the environmental effect x1*x2 representing the interaction between the environmental effect x1 and the environmental effect x2 will be added to the model equation.</p></li>
<li><p><code>B</code> (default <code><a href='https://rdrr.io/r/base/c.html'>c(0,0,0,0)</a></code>): <code>numeric vector</code>; the population mean values. When the number of trait is set to 1, the length of the vector is 4. The vector elements are respectively the population intercept (b0), the population  response to environmental influences x1 (fixed slope; b1), the population  response to environmental influences x2 (fixed slope; b2) and the population  response interaction between environmental influences x1 and x2 (fixed slope; b12). If the number of trait is set to 2, the length of the vector is doubled (len=8) and the second half corresponds to the population mean values associated with the second trait.</p></li>
<li><p><code>Vind</code> (default <code><a href='https://rdrr.io/r/base/matrix.html'>matrix(0, nrow=4, ncol=4)</a></code>): square, positive definite <code>matrix</code> or lower triangular <code>matrix</code>; the individual variance/correlation matrix. Variances are positive <code>numeric</code> numbers and correlations are <code>numeric</code> numbers ranged between -1 and 1. Variances are along the matrix diagonal and correlation values below the matrix diagonal. When the number of trait is set to 1, the dimension of the matrix is 4 rows by 4 columns (4x4) and the diagonal elements are respectively the individual-specific  (random) intercept variance (VI), the individual-specific response to an environmental effect x1 (random slope) variance (VS1), the individual-specific response to an environmental effect x2 (random slope) variance (VS2) and the individual-specific response interaction to two environmental effects x1 and x2 (random slopes) variance (VS12). When the number of trait is set to 2, the dimension of the matrix is doubled (8x8) where the second half of the diagonal is the individual variances (intercept and slopes) of the second trait. Note that it is possible to set correlation relationships between random effects within and/or among traits.</p></li>
<li><p><code>Ve</code> (default 0): positive <code>numeric</code>; the measurement error variance.</p></li>
<li><p><code>VG</code> (default 0): positive <code>numeric</code>; the high-level grouping variance.</p></li>
<li><p><code>NR</code> (default 1): positive <code>integer</code>; the average number of records sampled per individual.</p></li>
<li><p><code>Vhsi</code> (default 0): <code>numeric</code> (between 0 and 0.95); the among-individual variance in timing of sampling.</p></li>
<li><p><code>NR_ind</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, individuals will be sampled the same number of times.</p></li>
<li><p><code>NR_trait</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, traits within individuals will be sampled the same number of times.</p></li>
<li><p><code>ST_ind</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, individuals will be sampled at the same time (i.e. recorded simultaneously).</p></li>
<li><p><code>ST_trait</code> (default <code>TRUE</code>): <code>logical</code>; if <code>TRUE</code>, traits within individuals will be sampled at the same times (i.e. recorded simultaneously).</p></li>
</ul>

<p>When the full data of a previous squid simulation is passed to <code>squidR</code> through the argument <code>data</code>, <code>squidR</code> does not generate a new world and samples directly into the already existing world.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Allegue, H., Araya-Ajoy, Y.G., Dingemanse, N.J., Dochtermann N.A., Garamszegi, L.Z., Nakagawa, S., Reale, D., Schielzeth, H. and Westneat, D.F. (2016) SQuID - Statistical Quantification of Individual Differences: an educational and statistical tool for understanding multi-level phenotypic data in linear mixed models. <em>Methods in Ecology and Evolution</em>, <b>8</b>:257-267.</p>
<p>Dingemanse, N.J. and Dochtermann N.A. (2013) Quantifying individual variation in behaviour: mixed-effect modelling approaches. <em>Journal of Animal Ecology</em>, <b>82</b>:39-54.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='squidApp.html'>squidApp</a></code> to run the SQuID app which includes detailed documentation on the SQuID model and its sampling design.</p></div>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If this is your first experience with SQuID, we highly recommend to start with the interactive SQuID application with graphical interface in order to learn and get more familiarized with the SQuID model (phenotypic equation) and its sampling design (use the function <code><a href='squidApp.html'>squidApp</a></code>).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## create the input list ##</span>
<span class='va'>input</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>## define the model input parameters ##</span>

<span class='va'>input</span><span class='op'>$</span><span class='va'>Tmax</span> <span class='op'>&lt;-</span> <span class='fl'>100</span> <span class='co'># 100 time steps</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>NP</span>   <span class='op'>&lt;-</span> <span class='fl'>10</span>  <span class='co'># 10 replicated populations</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>NI</span>   <span class='op'>&lt;-</span> <span class='fl'>20</span>  <span class='co'># 20 individuals per replicate population</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>NT</span>   <span class='op'>&lt;-</span> <span class='fl'>1</span>   <span class='co'># 1 trait per individual</span>

<span class='co'># in this simulation model, only one environmental gradient (x1) is added</span>

<span class='co'># turn on the environmental gradient x1</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>X1_state</span>      <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>  

<span class='co'># add a stochastic environmental effect to the environmental effect x1</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>X1_sto_state</span>  <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>  

<span class='co'># the stochastic environmental effect included </span>
<span class='co'># into the environmental effect x1 is not shared among individual. </span>
<span class='co'># Each individual will experience a  different stochastic environmental effect. </span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>X1_sto_shared</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>                  

<span class='co'>#  add an autocorrelation effect to the stochastic </span>
<span class='co'>#  environmental effect within the environmental effect x1.</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>X1_sto_autocor_state</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> 

<span class='co'># define the autocorrelation value between two consecutive time steps.</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>X1_sto_corr</span>          <span class='op'>&lt;-</span> <span class='fl'>0.5</span> 

<span class='co'># add a linear trend to the environmental effect x1. </span>
<span class='co'># the default parameters for the linear trend will be used </span>
<span class='co'># (an intercept of 0, a slope of 1 and the linear trend will be shared among individuals)</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>X1_lin_state</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span> 

<span class='co'># define the population mean values vector.</span>
<span class='co'># the population mean (fixed intercept) and</span>
<span class='co'># the population mean response to environmental influences x1 (fixed slope) </span>
<span class='co'># are set to 0.1.</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>B</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>
                                                  
<span class='co'># define the individual variance/correlation matrix (squared matrix; 4x4)</span>
<span class='co'># the individual-specific deviation (random intercept; VI) variance is set to 0.7.</span>
<span class='co'># the individual-specific response to an environmental effect x1 (random slope; VS1) is set to 0.5.</span>
<span class='co'># the correlation between the individual-specific deviation (I) </span>
<span class='co'># and the individual-specific response </span>
<span class='co'># to an environmental effect x1 </span>
<span class='co'># (S1) is set to -0.7.                                                     </span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>Vind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.7</span>  , <span class='fl'>0</span>   , <span class='fl'>0</span> , <span class='fl'>0</span>,
                       <span class='op'>-</span><span class='fl'>0.7</span> , <span class='fl'>0.5</span> , <span class='fl'>0</span> , <span class='fl'>0</span>,
                       <span class='fl'>0</span>    , <span class='fl'>0</span>   , <span class='fl'>0</span> , <span class='fl'>0</span>,
                       <span class='fl'>0</span>    , <span class='fl'>0</span>   , <span class='fl'>0</span> , <span class='fl'>0</span><span class='op'>)</span>, 
      nrow<span class='op'>=</span><span class='fl'>4</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
                       
<span class='va'>input</span><span class='op'>$</span><span class='va'>Ve</span>  <span class='op'>&lt;-</span> <span class='fl'>0.05</span> <span class='co'># the measurement error variance</span>

<span class='co'>## define the sampling design ##</span>

<span class='co'># the mean number of records per individual</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>NR</span>     <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='co'># the among-individual variance in timing of sampling</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>Vhsi</span>   <span class='op'>&lt;-</span> <span class='fl'>0.2</span>
<span class='co'># individuals are not sampled the same number of times.</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>NR_ind</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> 
<span class='co'># individuals are not sampled at the time</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>ST_ind</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> 

<span class='co'>## run the simulation ##</span>
<span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'>squidR</span><span class='op'>(</span><span class='va'>input</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># plot the individual phenotype values over time</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>$</span><span class='va'>plot</span><span class='op'>$</span><span class='va'>totPhen</span><span class='op'>)</span> 
</div><div class='img'><img src='squidR-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># see first records of the simulated data set</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>$</span><span class='va'>full_data</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Replicate Individual Group Individual_Trait Trait Time Phenotype  B0  B1 B2
#&gt; 1         1          1     1                1     1    1 -2.680891 0.1 0.1  0
#&gt; 2         1          1     1                1     1    2 -2.400395 0.1 0.1  0
#&gt; 3         1          1     1                1     1    3 -2.641104 0.1 0.1  0
#&gt; 4         1          1     1                1     1    4 -2.552204 0.1 0.1  0
#&gt; 5         1          1     1                1     1    5 -2.376512 0.1 0.1  0
#&gt; 6         1          1     1                1     1    6 -2.563661 0.1 0.1  0
#&gt;   B12         I        S1 S2 S12        X1 X2 X1X2 G           e
#&gt; 1   0 -1.225056 0.7365136  0   0 -1.657984  0    0 0 -0.16890934
#&gt; 2   0 -1.225056 0.7365136  0   0 -1.690931  0    0 0  0.13914785
#&gt; 3   0 -1.225056 0.7365136  0   0 -1.659905  0    0 0 -0.12751497
#&gt; 4   0 -1.225056 0.7365136  0   0 -1.577768  0    0 0 -0.10732380
#&gt; 5   0 -1.225056 0.7365136  0   0 -1.561005  0    0 0  0.05434633
#&gt; 6   0 -1.225056 0.7365136  0   0 -1.566681  0    0 0 -0.12805517</div><div class='input'>
<span class='co'>## run a second simulation with the identical world but with a different sampling design </span>
<span class='co'>## where individuals are sampled the same number of times and at the same time    </span>

<span class='va'>input</span><span class='op'>$</span><span class='va'>NR_ind</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span> <span class='co'># individuals are sampled the same number of times.</span>
<span class='va'>input</span><span class='op'>$</span><span class='va'>ST_ind</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span> <span class='co'># individuals are sampled at the time</span>

<span class='va'>output2</span> <span class='op'>&lt;-</span> <span class='fu'>squidR</span><span class='op'>(</span><span class='va'>input</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span>, data<span class='op'>=</span><span class='va'>output</span><span class='op'>$</span><span class='va'>full_data</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hassen Allegue, Yimen G. Araya-Ajoy, Niels J. Dingemanse, Ned A. Dochtermann, Laszlo Z. Garamszegi, Shinichi Nakagawa, Denis Reale, Holger Schielzeth, David F. Westneat.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


